!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="2288e525-d4dc-4d9c-8e7b-584667f0ebd1",e._sentryDebugIdIdentifier="sentry-dbid-2288e525-d4dc-4d9c-8e7b-584667f0ebd1")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[937,4986],{15301:(e,n,t)=>{"use strict";t.d(n,{A:()=>L});var o=t(80263),l=t(23445),a=t(15601),i=t.n(a),r=t(73969),s=t(15998),c=t(98832),d=t(90309),u=t(32144),m=t(80251),f=t(64813),p=t(15629),g=t(667),h=t(66628),b=t(22918),y=t(46144);async function v(e){let{projectRef:n,connectionString:t,table:o,filters:l,roleImpersonationState:a}=e,i=(0,g.Nf)(function(e){var n;let{table:t,filters:o}=e,l=new f.Query().from(t.name,null!=(n=t.schema)?n:void 0).delete();return o.filter(e=>e.value&&""!==e.value).forEach(e=>{let n=(0,y.b)(t,e);l=l.filter(e.column,e.operator,n)}),l.toSql()}({table:o,filters:l}),a),{result:r}=await (0,p.E)({projectRef:n,connectionString:t,sql:i,isRoleImpersonationEnabled:(0,h._c)(null==a?void 0:a.role)});return r}let x=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=(0,u.jE)();return(0,m.n)(e=>v(e),{async onSuccess(n,t,l){let{projectRef:a,table:i}=t;await o.invalidateQueries(b.j.tableRowsAndCount(a,i.id)),await (null==e?void 0:e(n,t,l))},async onError(e,t,o){void 0===n?r.oR.error("Failed to delete all table rows: ".concat(e.message)):n(e,t,o)},...t})};var w=t(58696),j=t(62136);async function D(e){let{projectRef:n,connectionString:t,table:o,rows:l,roleImpersonationState:a}=e,i=(0,g.Nf)(function(e){var n;let{table:t,rows:o}=e,{primaryKeys:l,error:a}=(0,y.j)({table:t});if(a)throw a;let i=new f.Query().from(t.name,null!=(n=t.schema)?n:void 0).delete();return null==l||l.forEach(e=>{let n=o.map(n=>n[e]);i=i.filter(e,"in",n)}),i.toSql()}({table:o,rows:l}),a),{result:r}=await (0,p.E)({projectRef:n,connectionString:t,sql:i,isRoleImpersonationEnabled:(0,h._c)(null==a?void 0:a.role)});return r}let C=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=(0,u.jE)();return(0,m.n)(e=>D(e),{async onSuccess(n,t,o){let{projectRef:a,table:i}=t;await l.invalidateQueries(b.j.tableRowsAndCount(a,i.id)),await (null==e?void 0:e(n,t,o))},async onError(e,t,l){if(void 0===n){let{table:n,rows:l}=t,a=e.message.includes("Please add a primary key column"),i=e.message.includes("violates foreign key constraint"),s=l.length>1;if(i){let t=n.name,l=e.message.split("on table ")[2].replaceAll('"',""),a=e.message.split("foreign key constraint")[1].split("on table")[0].replaceAll('"',""),i=s?"Unable to delete rows as one of them is currently referenced by a foreign key constraint from the table `".concat(l,"`."):"Unable to delete row as it is currently referenced by a foreign key constraint from the table `".concat(l,"`."),c="Set an on delete behavior on the foreign key relation `".concat(a,"` in the `").concat(l,"` table to automatically respond when row(s) are being deleted in the `").concat(t,"` table.");(0,r.oR)(i,{description:(0,o.jsx)(w.o,{content:c,className:"[&>p]:m-0"}),action:(0,o.jsx)("div",{className:"w-full flex gap-x-2 !mx-0 mt-3",children:(0,o.jsx)(j.A,{href:"https://supabase.com/docs/guides/database/postgres/cascade-deletes"})})})}else a?(0,r.oR)("Unable to delete row(s) as table has no primary keys",{description:(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{className:"text-sm text-foreground-light",children:"Add a primary key column to your table first to serve as a unique identifier for each row before updating or deleting the row."}),(0,o.jsx)("div",{className:"mt-3",children:(0,o.jsx)(j.A,{href:"https://supabase.com/docs/guides/database/tables#primary-keys"})})]})}):r.oR.error("Failed to delete table row: ".concat(e.message))}else n(e,t,l)},...t})};async function S(e){let{projectRef:n,connectionString:t,table:o}=e,l=function(e){var n;let{table:t}=e;return new f.Query().from(t.name,null!=(n=t.schema)?n:void 0).truncate().toSql()}({table:o}),{result:a}=await (0,p.E)({projectRef:n,connectionString:t,sql:l});return a}let A=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=(0,u.jE)();return(0,m.n)(e=>S(e),{async onSuccess(n,t,l){let{projectRef:a,table:i}=t;await o.invalidateQueries(b.j.tableRowsAndCount(a,i.id)),await (null==e?void 0:e(n,t,l))},async onError(e,t,o){void 0===n?r.oR.error("Failed to truncate table row: ".concat(e.message)):n(e,t,o)},...t})};var k=t(95865),R=t(79033),N=t(35768),E=t(1012),T=t(40022),_=t(50204);let L=e=>{var n,t,a,u,m,f,p,g,b;let{selectedTable:y,onTableDeleted:v}=e,{project:w}=(0,c.Om)(),j=(0,R.ap)(),{filters:D,onApplyFilters:S}=(0,s.M)(),L=e=>{let{columnName:n}=e;S(D.filter(e=>e.column!==n))},{mutate:I}=(0,d.T)({onSuccess:()=>{var e;if((null==(e=j.confirmationDialog)?void 0:e.type)!=="column")return;let n=j.confirmationDialog.column;L({columnName:n.name}),r.oR.success('Successfully deleted column "'.concat(n.name,'"'))},onError:e=>{var n;if((null==(n=j.confirmationDialog)?void 0:n.type)!=="column")return;let t=j.confirmationDialog.column;r.oR.error("Failed to delete ".concat(t.name,": ").concat(e.message))},onSettled:()=>{j.closeConfirmationDialog()}}),{mutate:F}=(0,k.A)({onSuccess:async()=>{r.oR.success('Successfully deleted table "'.concat(null==y?void 0:y.name,'"')),null==v||v()},onError:e=>{r.oR.error("Failed to delete ".concat(null==y?void 0:y.name,": ").concat(e.message))},onSettled:()=>{j.closeConfirmationDialog()}}),{mutate:q,isLoading:Q}=C({onSuccess:()=>{var e,n,t;(null==(e=j.confirmationDialog)?void 0:e.type)==="row"&&(null==(n=(t=j.confirmationDialog).callback)||n.call(t)),r.oR.success("Successfully deleted selected row(s)")},onSettled:()=>{j.closeConfirmationDialog()}}),{mutate:P,isLoading:z}=x({onSuccess:()=>{var e,n,t;(null==(e=j.confirmationDialog)?void 0:e.type)==="row"&&(null==(n=(t=j.confirmationDialog).callback)||n.call(t)),r.oR.success("Successfully deleted selected rows")},onError:e=>{r.oR.error("Failed to delete rows: ".concat(e.message))},onSettled:()=>{j.closeConfirmationDialog()}}),{mutate:M,isLoading:W}=A({onSuccess:()=>{var e,n,t;(null==(e=j.confirmationDialog)?void 0:e.type)==="row"&&(null==(n=(t=j.confirmationDialog).callback)||n.call(t)),r.oR.success("Successfully deleted all rows from table")},onError:e=>{r.oR.error("Failed to delete rows: ".concat(e.message))},onSettled:()=>{j.closeConfirmationDialog()}}),H=(null==(n=j.confirmationDialog)?void 0:n.type)==="row"&&j.confirmationDialog.allRowsSelected,O=(null==(t=j.confirmationDialog)?void 0:t.type)==="row"?j.confirmationDialog.allRowsSelected?null!=(b=j.confirmationDialog.numRows)?b:0:j.confirmationDialog.rows.length:0,U=((null==(a=j.confirmationDialog)?void 0:a.type)==="column"||(null==(u=j.confirmationDialog)?void 0:u.type)==="table")&&j.confirmationDialog.isDeleteWithCascade,X=async()=>{var e;if((null==(e=j.confirmationDialog)?void 0:e.type)!=="column"||void 0===w)return;let n=j.confirmationDialog.column;void 0!==n&&I({column:n,cascade:U,projectRef:w.ref,connectionString:null==w?void 0:w.connectionString})},B=async()=>{var e;(null==(e=j.confirmationDialog)?void 0:e.type)==="table"&&void 0!==y&&F({projectRef:null==w?void 0:w.ref,connectionString:null==w?void 0:w.connectionString,id:y.id,name:y.name,schema:y.schema,cascade:U})},K=(0,h.Qj)(),$=async()=>{var e;if(!w)return console.error("Project ref is required");if(!y)return console.error("Selected table required");if((null==(e=j.confirmationDialog)?void 0:e.type)!=="row")return;let n=j.confirmationDialog.rows;if(j.confirmationDialog.allRowsSelected)if(0===D.length){if(void 0!==K().role)return j.closeConfirmationDialog(),r.oR.error("Table truncation is not supported when impersonating a role");M({projectRef:w.ref,connectionString:w.connectionString,table:y})}else P({projectRef:w.ref,connectionString:w.connectionString,table:y,filters:D,roleImpersonationState:K()});else q({projectRef:w.ref,connectionString:w.connectionString,table:y,rows:n,roleImpersonationState:K()})};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(_.A,{variant:"destructive",size:"small",visible:(null==(m=j.confirmationDialog)?void 0:m.type)==="column",title:'Confirm deletion of column "'.concat((null==(f=j.confirmationDialog)?void 0:f.type)==="column"&&j.confirmationDialog.column.name,'"'),confirmLabel:"Delete",confirmLabelLoading:"Deleting",onCancel:()=>{j.closeConfirmationDialog()},onConfirm:X,"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"DeleteConfirmationDialogs.tsx",children:(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsx)("p",{className:"text-sm text-foreground-light",children:"Are you sure you want to delete the selected column? This action cannot be undone."}),(0,o.jsx)(N.A,{label:"Drop column with cascade?",description:"Deletes the column and its dependent objects",checked:U,onChange:()=>j.toggleConfirmationIsWithCascade(),"data-sentry-element":"Checkbox","data-sentry-source-file":"DeleteConfirmationDialogs.tsx"}),U&&(0,o.jsxs)(E.Fc,{variant:"warning",title:"Warning: Dropping with cascade may result in unintended consequences",children:[(0,o.jsx)(E.XL,{children:"All dependent objects will be removed, as will any objects that depend on them, recursively."}),(0,o.jsx)(E.TN,{children:(0,o.jsx)(T.$,{asChild:!0,size:"tiny",type:"default",icon:(0,o.jsx)(l.A,{}),children:(0,o.jsx)(i(),{href:"https://www.postgresql.org/docs/current/ddl-depend.html",target:"_blank",rel:"noreferrer",children:"About dependency tracking"})})})]})]})}),(0,o.jsx)(_.A,{variant:"destructive",size:"small",visible:(null==(p=j.confirmationDialog)?void 0:p.type)==="table",title:(0,o.jsx)("span",{className:"break-words",children:'Confirm deletion of table "'.concat(null==y?void 0:y.name,'"')}),confirmLabel:"Delete",confirmLabelLoading:"Deleting",onCancel:()=>{j.closeConfirmationDialog()},onConfirm:B,"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"DeleteConfirmationDialogs.tsx",children:(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsx)("p",{className:"text-sm text-foreground-light",children:"Are you sure you want to delete the selected table? This action cannot be undone."}),(0,o.jsx)(N.A,{label:"Drop table with cascade?",description:"Deletes the table and its dependent objects",checked:U,onChange:()=>j.toggleConfirmationIsWithCascade(!U),"data-sentry-element":"Checkbox","data-sentry-source-file":"DeleteConfirmationDialogs.tsx"}),U&&(0,o.jsxs)(E.Fc,{variant:"warning",children:[(0,o.jsx)(E.XL,{children:"Warning: Dropping with cascade may result in unintended consequences"}),(0,o.jsx)(E.TN,{children:"All dependent objects will be removed, as will any objects that depend on them, recursively."}),(0,o.jsx)(E.TN,{className:"mt-4",children:(0,o.jsx)(T.$,{asChild:!0,size:"tiny",type:"default",icon:(0,o.jsx)(l.A,{}),children:(0,o.jsx)(i(),{href:"https://www.postgresql.org/docs/current/ddl-depend.html",target:"_blank",rel:"noreferrer",children:"About dependency tracking"})})})]})]})}),(0,o.jsx)(_.A,{variant:"destructive",size:"small",visible:(null==(g=j.confirmationDialog)?void 0:g.type)==="row",title:(0,o.jsxs)("p",{className:"break-words",children:[(0,o.jsx)("span",{children:"Confirm to delete the selected row"}),(0,o.jsx)("span",{children:O>1&&"s"})]}),confirmLabel:"Delete",confirmLabelLoading:"Deleting",onCancel:()=>j.closeConfirmationDialog(),onConfirm:()=>$(),loading:W||Q||z,"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"DeleteConfirmationDialogs.tsx",children:(0,o.jsx)("div",{className:"space-y-4",children:(0,o.jsxs)("p",{className:"text-sm text-foreground-light",children:[(0,o.jsx)("span",{children:"Are you sure you want to delete "}),(0,o.jsxs)("span",{children:[H?"all":"the selected"," "]}),(0,o.jsx)("span",{children:O>1&&"".concat(O," ")}),(0,o.jsx)("span",{children:"row"}),(0,o.jsx)("span",{children:O>1&&"s"}),(0,o.jsx)("span",{children:"? This action cannot be undone."})]})})})]})}},15478:(e,n,t)=>{"use strict";t.d(n,{A:()=>s});var o=t(80263),l=t(46115),a=t(53239),i=t(70800);let r=e=>{var n,t,r;let{defaultActiveId:s,activeId:c,type:d="pills",size:u="tiny",block:m,onChange:f,onClick:p,scrollable:g,wrappable:h,addOnBefore:b,addOnAfter:y,listClassNames:v,baseClassNames:x,refs:w,children:j}=e,D=a.Children.toArray(j),[C,S]=(0,a.useState)(null!=(r=null!=c?c:s)?r:null==D||null==(t=D[0])||null==(n=t.props)?void 0:n.id);(0,a.useMemo)(()=>{c&&c!==C&&S(c)},[c]);let A=(0,i.A)("tabs");function k(e){null==p||p(e),e!==C&&(null==f||f(e),S(e))}let R=[A[d].list];return g&&R.push(A.scrollable),h&&R.push(A.wrappable),v&&R.push(v),(0,o.jsxs)(l.bL,{value:C,className:[A.base,x].join(" "),ref:null==w?void 0:w.base,"data-sentry-element":"unknown","data-sentry-component":"Tabs","data-sentry-source-file":"Tabs.tsx",children:[(0,o.jsxs)(l.B8,{className:R.join(" "),ref:null==w?void 0:w.list,"data-sentry-element":"unknown","data-sentry-source-file":"Tabs.tsx",children:[b,D.map(e=>{let n=C===e.props.id,t=[A[d].base,A.size[u]];return n?t.push(A[d].active):t.push(A[d].inactive),m&&t.push(A.block),(0,o.jsxs)(l.l9,{onKeyDown:n=>{"Enter"===n.key&&(n.preventDefault(),k(e.props.id))},onClick:()=>k(e.props.id),value:e.props.id,className:t.join(" "),children:[e.props.icon,(0,o.jsx)("span",{children:e.props.label}),e.props.iconRight]},"".concat(e.props.id,"-tab-button"))}),y]}),D]})};r.Panel=e=>{let{children:n,id:t,className:a}=e,r=(0,i.A)("tabs");return(0,o.jsx)(l.UC,{value:t,className:[r.content,a].join(" "),"data-sentry-element":"unknown","data-sentry-component":"Panel","data-sentry-source-file":"Tabs.tsx",children:n})};let s=r},20814:(e,n,t)=>{"use strict";t.d(n,{H:()=>o.A});var o=t(48902)},37690:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>b});var o=t(80263),l=t(53239),a=t(90478),i=t(58642),r=t(20814),s=t(15301),c=t(46221),d=t(1356),u=t(92882),m=t(92512),f=t(41728),p=t(79033),g=t(67920);let h=()=>{let{ref:e}=(0,a.g)(),n=(0,p.ap)(),[t,c]=(0,l.useState)();return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(u.eh,{"data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"index.tsx",children:(0,o.jsx)(u.gu,{"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"index.tsx",children:(0,o.jsxs)("div",{className:"col-span-12",children:[(0,o.jsx)(m.M,{title:"Database Tables","data-sentry-element":"FormHeader","data-sentry-source-file":"index.tsx"}),(0,o.jsx)(i.B3,{onAddTable:n.onAddTable,onEditTable:e=>{c((0,f.ID)(e)),n.onEditTable()},onDeleteTable:e=>{c((0,f.ID)(e)),n.onDeleteTable()},onDuplicateTable:e=>{c((0,f.ID)(e)),n.onDuplicateTable()},"data-sentry-element":"TableList","data-sentry-source-file":"index.tsx"})]})})}),void 0!==e&&void 0!==t&&(0,f.KO)(t)&&(0,o.jsx)(g.HQ,{projectRef:e,table:t,children:(0,o.jsx)(s.A,{selectedTable:t})},"table-editor-table-".concat(t.id)),(0,o.jsx)(r.H,{includeColumns:!0,selectedTable:t,"data-sentry-element":"SidePanelEditor","data-sentry-source-file":"index.tsx"})]})};h.getLayout=e=>(0,o.jsx)(d.A,{children:(0,o.jsx)(c.A,{title:"Database",children:e})});let b=h},94118:(e,n,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/database/tables",function(){return t(37690)}])}},e=>{var n=n=>e(e.s=n);e.O(0,[89,4335,726,4280,3730,2981,6110,386,7661,5599,8445,4024,3019,7654,8274,7803,9146,5549,5007,4017,8398,4560,7795,3895,4444,7182,279,6418,2712,7686,8821,2690,1356,5756,8098,2187,3258,7963,6593,636,8792],()=>n(94118)),_N_E=e.O()}]);